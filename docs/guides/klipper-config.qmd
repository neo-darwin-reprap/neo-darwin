---
title: "Klipper Configuration"
---

# Klipper Configuration

Base configuration for your Tier {{< var tier >}} Amalgam.

## Printer Section

```ini
[printer]
kinematics: cartesian
max_velocity: 150
max_accel: 3000
max_accel_to_decel: 1500
square_corner_velocity: 5.0
```

::: {.callout-note}
Run `python scripts/analyze.py` for acceleration limits specific to your rod/extruder combination.
:::

## MCU Configuration

### {{< var primary_board >}}

```ini
[mcu]
# Update with your serial port
serial: /dev/serial/by-id/usb-Klipper_stm32f407xx_XXXX
```

## Stepper Configuration

### X Axis

```ini
[stepper_x]
step_pin: PE2
dir_pin: !PE3
enable_pin: !PE4
microsteps: 16
rotation_distance: 40  # GT2 belt, 20T pulley
endstop_pin: ^!PC1
position_endstop: 0
position_max: {{< var bed_x >}}
homing_speed: 50
```

### Y Axis

```ini
[stepper_y]
step_pin: PE5
dir_pin: !PE6
enable_pin: !PE4
microsteps: 16
rotation_distance: 40
endstop_pin: ^!PC2
position_endstop: 0
position_max: {{< var bed_y >}}
homing_speed: 50
```

### Z Axis

::: {.panel-tabset}
## Triple-Z (Tier 2-3)

```ini
[stepper_z]
step_pin: PA3
dir_pin: PA4
enable_pin: !PE4
microsteps: 16
rotation_distance: 8  # T8 leadscrew
endstop_pin: probe:z_virtual_endstop
position_max: {{< var build_z >}}
position_min: -5
homing_speed: 10

[stepper_z1]
step_pin: PA5
dir_pin: PA6
enable_pin: !PE4
microsteps: 16
rotation_distance: 8

[stepper_z2]
step_pin: PA7
dir_pin: PA8
enable_pin: !PE4
microsteps: 16
rotation_distance: 8

[z_tilt]
z_positions:
    -50, {{< var bed_y >}}/2
    {{< var bed_x >}}/2, {{< var bed_y >}}+50
    {{< var bed_x >}}+50, {{< var bed_y >}}/2
points:
    30, {{< var bed_y >}}/2
    {{< var bed_x >}}/2, {{< var bed_y >}}-30
    {{< var bed_x >}}-30, {{< var bed_y >}}/2
speed: 150
horizontal_move_z: 5
retries: 5
retry_tolerance: 0.0075
```

## Belt-Z (Tier 1)

```ini
[stepper_z]
step_pin: PA3
dir_pin: PA4
enable_pin: !PE4
microsteps: 16
rotation_distance: 8  # T8 leadscrew
endstop_pin: probe:z_virtual_endstop
position_max: {{< var build_z >}}
position_min: -5
homing_speed: 10

# Note: Belt-Z uses single motor driving both Z rods
# No z_tilt section needed, but manual leveling required
```

:::

## Extruder

```ini
[extruder]
step_pin: PD5
dir_pin: !PD6
enable_pin: !PE4
microsteps: 16
# {{< var extruder_type >}} settings:
rotation_distance: 7.71  # Adjust after calibration
gear_ratio: 3:1  # For Pitan
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: PA1
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PA0
min_temp: 0
max_temp: 280
min_extrude_temp: 170
max_extrude_only_distance: 100.0

[tmc2209 extruder]
uart_pin: PD4
run_current: 0.6
stealthchop_threshold: 999999
```

## Heated Bed

```ini
[heater_bed]
heater_pin: PA2
sensor_type: EPCOS 100K B57560G104F
sensor_pin: PA3
min_temp: 0
max_temp: 120
```

## Probe

```ini
[probe]
pin: ^!PC14
x_offset: -42
y_offset: -5
#z_offset: 0  # Set via PROBE_CALIBRATE
speed: 5.0
samples: 3
samples_result: median
sample_retract_dist: 3.0
samples_tolerance: 0.006
samples_tolerance_retries: 3
```

## Bed Mesh

```ini
[bed_mesh]
speed: 150
horizontal_move_z: 5
mesh_min: 30, 30
mesh_max: {{< var bed_x >}}-30, {{< var bed_y >}}-30
probe_count: 5, 5
algorithm: bicubic
fade_start: 1
fade_end: 10
```

## Input Shaper

```ini
[input_shaper]
# Run SHAPER_CALIBRATE after assembly
#shaper_freq_x: 50
#shaper_freq_y: 50
#shaper_type: mzv
```

## Fan Configuration

```ini
[fan]
pin: PA8

[heater_fan hotend_fan]
pin: PA9
heater: extruder
heater_temp: 50.0
```

---

::: {.callout-warning}
## Board-Specific Pins
The pin assignments above are examples. Verify against your {{< var primary_board >}} pinout diagram.
:::

## Next Steps

1. Flash Klipper to your board
2. Update MCU serial path
3. Verify pin assignments for your board
4. Run initial homing tests
5. Calibrate extruder rotation_distance
6. Run PROBE_CALIBRATE for Z offset
7. Run SHAPER_CALIBRATE for input shaper
